# architecture-sprint-1-result

## Разделение монолитного фронтира architecture-sprint-1 на микрофронтенды
> Реализованы уровень 1 и уровень 2.
### 1. Определение бизнес-функций и разделение функционала на микрофронтенды руководствуясь принципами DDD
Проект содержит следующий функционал:
- Загрузка карточки
- Удаление карточки
- Сбор и учёт лайков под карточкой
- Создание профиля и его редактирование  
- Регистрация и аутентификация пользователя

#### Следуя принципам DDD этот функционал можно разбить на три микрофронтенда и хост приложение:
* Хост - основное приложение, который загружает все необходимые микрофронтенды при необходимости и содержит общие
элементы (host)
* Регистрация и аутентификация пользователя (микрофронтенд auth):
  - Регистрация пользователя
  - Вход пользователя в профиль
  - Выход пользователя
  - Управление токенами доступа
* Редактирование профиля (управление профилем пользователя, микрофронтенд profile):
  - Просмотр информации о пользователе
  - Редактирование аватара
  - Редактирование имени пользователя и его занятия
* Загрузка и удаление карточек (управление контентом, микрофронтенд cards):
  - Просмотр списка карточек
  - Просмотр отдельной карточки
  - Создание карточки
  - Удаление карточки
  - Действие "Лайк"
  - Отображение отмеченного лайка и общего количества лайков

Отдельный микрофронтенд для лайков не нужен, т.к. лайки встроены в карточки и нет сложной логики обработки лайков, а
также нет отдельной страницы, где бы лайки отображались отдельно, например для аналитики по лайкам.

---

### 2. Выбор метода реализации
- Для независимого развёртывания микрофронтендов, а также для большей свободы команд я решил использовать runtime
интеграцию.
- Функционал приложения построен для активного взаимодействия с пользователем (добавление, удаление карточки, лайки
и т.п.). Не требуется SEO оптимизация т.к. на главной странице есть только возможность логина и регистрации. В данном
случае больше всего подходит клиентская компоновка с возможностью подгрузки необходимых модулей по требованию (lazy).

---

### 3. Выбор инструмента для создания микрофронтенда
Для текущего проекта я выбрал Webpack Module Federation:
- Поддерживает dependency sharing для оптимизации использования общих зависимостей (React, Redux). Это хорошо для
оптимизации.
- Лучше подходит для приложения с одним фреймворком (React), что упрощает настройку.
- Позволяет разделять проект на модули, которые могут быть разрабатываемы и развёртываемы независимо.

Клиентская компоновка с lazy-загрузкой позволяет загружать только те части, которые необходимы пользователю в
конкретный момент.

---

### 4. Настройка межмодульного взаимодействия
Для межмодульного взаимодействия можно использовать:
- API/BFF
- Глобальное состояние (React redux)
- PUB/SUB  

В данном проекте уже используется React redux (глобальное состояние). Поэтому логичным решением будет продолжить его
использование. Также это хорошо для упрощения разработки, потому что на клиентской части необходимо хранить данные об
аутентификации пользователя. API/BFF и PUB/SUB в данном случае переусложнят разработку для такого простого проекта.

### Структура директорий проекта

Проект разделён на три микрофронтенда и хост приложение:

```
frontend/
├── auth/                        # Микрофронтенд для авторизации
│   ├── src/
│   │   ├── components/
│   │   │   ├── InfoTooltip.js
│   │   │   ├── Login.js
│   │   │   └── Register.js
│   │   └── index.js
│   └── webpack.config.js
├── cards/                       # Микрофронтенд для управления карточками
│   ├── src/
│   │   ├── components/
│   │   │   ├── AddPlacePopup.js
│   │   │   ├── Card.js
│   │   │   ├── ImagePopup.js
│   │   │   └── PopupWithForm.js
│   │   └── index.js
│   └── webpack.config.js
├── host/                        # Хост-приложение
│   ├── src/
│   │   ├── components/
│   │   │   ├── App.js
│   │   │   ├── Footer.js
│   │   │   ├── Header.js
│   │   │   ├── Main.js
│   │   │   └── ProtectedRoute.js
│   │   └── index.js
│   └── webpack.config.js
├── profile/                     # Микрофронтенд для профиля
│   ├── src/
│   │   ├── components/
│   │   │   ├── EditProfilePopup.js
│   │   │   ├── EditAvatarPopup.js
│   │   │   └── PopupWithForm.js
│   │   └── index.js
│   └── webpack.config.js
└── .gitignore
```